<div class="page-container">
  <div class="page-header">
    <div>
      <h1>{{ isEditing ? 'Editar' : 'Nova' }} Transa√ß√£o</h1>
      <p>{{ isEditing ? 'Edite os dados da transa√ß√£o' : 'Preencha os dados da nova transa√ß√£o' }}</p>
    </div>
    <button class="btn btn-secondary" routerLink="/transactions">
      ‚Üê Voltar
    </button>
  </div>

  <div class="form-container">
    <form [formGroup]="transactionForm" (ngSubmit)="onSubmit()" class="transaction-form">
      <!-- Tipo de Transa√ß√£o -->
      <div class="form-section">
        <h3>Tipo de Transa√ß√£o</h3>
        <div class="type-selector">
          <label class="type-option" [class.selected]="type?.value === 'receivable'">
            <input type="radio" formControlName="type" value="receivable">
            <span class="type-icon receivable">üì•</span>
            <span class="type-label">A Receber</span>
          </label>
          
          <label class="type-option" [class.selected]="type?.value === 'payable'">
            <input type="radio" formControlName="type" value="payable">
            <span class="type-icon payable">üì§</span>
            <span class="type-label">A Pagar</span>
          </label>
        </div>
        <div class="form-error" *ngIf="type?.invalid && type?.touched">
          Selecione o tipo de transa√ß√£o
        </div>
      </div>

      <!-- Informa√ß√µes B√°sicas -->
      <div class="form-section">
        <h3>Informa√ß√µes B√°sicas</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Descri√ß√£o *</label>
            <input 
              type="text" 
              class="form-input" 
              formControlName="description" 
              placeholder="Ex: Sal√°rio, Aluguel, etc."
              [class.is-invalid]="description?.invalid && description?.touched"
            >
            <div class="form-error" *ngIf="description?.invalid && description?.touched">
              <span *ngIf="description?.errors?.['required']">Descri√ß√£o √© obrigat√≥ria</span>
              <span *ngIf="description?.errors?.['minlength']">M√≠nimo 3 caracteres</span>
            </div>
          </div>
        </div>

        <div class="form-row grid-2">
          <div class="form-group">
            <label class="form-label">Valor *</label>
            <div class="currency-input">
              <span class="currency-symbol">R$</span>
              <input 
                type="number" 
                class="form-input" 
                formControlName="amount" 
                step="0.01" 
                min="0.01"
                placeholder="0,00"
                [class.is-invalid]="amount?.invalid && amount?.touched"
              >
            </div>
            <div class="form-error" *ngIf="amount?.invalid && amount?.touched">
              <span *ngIf="amount?.errors?.['required']">Valor √© obrigat√≥rio</span>
              <span *ngIf="amount?.errors?.['min']">Valor deve ser maior que zero</span>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Data de Vencimento *</label>
            <input 
              type="date" 
              class="form-input" 
              formControlName="dueDate"
              [class.is-invalid]="dueDate.invalid && dueDate.touched"
            >
            <div class="form-error" *ngIf="dueDate.invalid && dueDate.touched">
              <span *ngIf="dueDate.errors?.['required']">Data de vencimento √© obrigat√≥ria</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Informa√ß√µes Adicionais -->
      <div class="form-section">
        <h3>Informa√ß√µes Adicionais</h3>
        
        <div class="form-row grid-2">
          <div class="form-group">
            <label class="form-label">Categoria</label>
            <select class="form-input" formControlName="category">
              <option value="">Selecione uma categoria</option>
              <option value="Alimenta√ß√£o">Alimenta√ß√£o</option>
              <option value="Transporte">Transporte</option>
              <option value="Moradia">Moradia</option>
              <option value="Sa√∫de">Sa√∫de</option>
              <option value="Educa√ß√£o">Educa√ß√£o</option>
              <option value="Lazer">Lazer</option>
              <option value="Investimentos">Investimentos</option>
              <option value="Sal√°rio">Sal√°rio</option>
              <option value="Outros">Outros</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label">Status</label>
            <select class="form-input" formControlName="status">
              <option value="pending">Pendente</option>
              <option value="paid">Pago</option>
              <option value="cancelled">Cancelado</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Observa√ß√µes</label>
            <textarea 
              class="form-input" 
              formControlName="notes" 
              rows="4"
              placeholder="Informa√ß√µes adicionais sobre a transa√ß√£o..."
            ></textarea>
          </div>
        </div>

        <!-- Data de Pagamento (mostrar apenas se status for 'paid') -->
        <div class="form-row" *ngIf="status?.value === 'paid'">
          <div class="form-group">
            <label class="form-label">Data de Pagamento</label>
            <input 
              type="date" 
              class="form-input" 
              formControlName="paidAt"
            >
          </div>
        </div>
      </div>

      <!-- Bot√µes -->
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" routerLink="/transactions">
          Cancelar
        </button>
        <button 
          type="submit" 
          class="btn btn-primary" 
          [disabled]="transactionForm.invalid || isSaving"
        >
          <span *ngIf="!isSaving">{{ isEditing ? 'Salvar Altera√ß√µes' : 'Criar Transa√ß√£o' }}</span>
          <div class="spinner" *ngIf="isSaving"></div>
        </button>
      </div>

      <div class="alert alert-success" *ngIf="successMessage">
        {{ successMessage }}
      </div>

      <div class="alert alert-error" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>
    </form>
  </div>
</div>